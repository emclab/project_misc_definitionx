<% if @view_in_config && @erb_code %>
  <%= render inline: @erb_code, locals: {models: models} %>
  
<% else %>  
<div class="pagination"><%= will_paginate models %></div>
    <h4><%=@title + '-' + t(@definition_category.sub('_', ' ').pluralize.titleize) if @definition_cateogry.present? %></h4>
    <h4><%=@title if @definition_cateogry.blank? %></h4>
  <table class="table table-striped">
  	<p><%=t('Project')%>=<%=@project.name if @project %></p>
  	<p><%= form_tag misc_definitions_path(format: "csv", :project_id => @project.id, csv_for: 'role_definition'), method: :get do %>
     <div class="form-inputs">
	   <%= label_tag(:index_from, "Index From") %>
       <%= text_field_tag('index_from', '1', size: 6) %>
       <%= label_tag(:token, "Token ") %>
       <%= text_field_tag('token?', '', size: 12) %>
  
	   <%= submit_tag 'CSV' %>
	 </div>
  <% end if @project && @definition_category == 'role_definition' %></p>
    <tr>
      <th><%= t('Create Date') %></th>
      <th><%= t('Name') %></th>
      <th><%= t('Description') %></th>
      <th><%= t('Ranking Index') %></th>
      <th><%= t('Ranking Index') %></th>
      <th><%= t('Entered By') %></th>
      <th></th>
    </tr>

    <% models.each do |r| %>
        <tr>
          <td><%= (r.created_at + 8.hours).strftime("%Y/%m/%d")%></td>
          <td><%= link_to r.name, SUBURI + "/view_handler?index=1&url=#{misc_definition_path(r, subaction: @definition_category)}" %></td>
          <td><%= r.desp %></td>
          <td><%= r.ranking_index %></td>
          <td><%= r.last_updated_by.name if r.last_updated_by_id.present? %></td>
          <td><%= link_to t('Edit'), edit_misc_definition_path(r, :subaction => @definition_category, definition_category: @definition_category, :format => :js), 
                  :remote => true, :class => BUTTONS_CLS['action'] if has_action_right?('update_' + @definition_category, params[:controller], r) %></td>
          <td><%= link_to t('Edit'), edit_misc_definition_path(r, definition_category: @definition_category, :format => :js), 
                  :remote => true, :class => BUTTONS_CLS['action'] if has_action_right?('update', params[:controller], r) %></td>
        </tr>
    <% end %>

  </table>

	<table class="table table-striped">
	  <tr>
	    <th>
	    	<%= link_to t('Back'), SUBURI + "/authentify/view_handler?index=0", :id => 'close', :class => BUTTONS_CLS['action'] %>
	    	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<%= link_to t("New " + @definition_category.titleize), new_misc_definition_path(:definition_category => @definition_category.strip, :subaction => @definition_category.strip, :project_id => @project.id, :format => :js), :remote => true, 
               :id => 'new_log_link', :class => BUTTONS_CLS['action'] if has_action_right?('create_' + @definition_category, params[:controller]) %> 
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			<%= link_to t("New " + @definition_category.titleize), new_misc_definition_path(:definition_category => @definition_category.strip, :project_id => @project.id, :format => :js), :remote => true, 
               :id => 'new_log_link', :class => BUTTONS_CLS['action'] if has_action_right?('create', params[:controller]) %>   
		</th>
	  </tr>
	</table>

</div>
 
 <% end %> 
